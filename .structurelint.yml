# Structurelint Configuration for LangPlug
# Enforces project structure, organization, and architectural integrity
# See: https://github.com/structurelint/structurelint

root: true

# Global rules for all directories (BEST PRACTICE LIMITS)
rules:
  # Maximum folder depth to prevent over-nesting
  # Best practice: 6-7 levels maximum
  max-depth: { max: 7 }

  # Maximum files per directory to maintain organization
  # Best practice: 15-20 files (forces modularization)
  max-files-in-dir: { max: 20 }

  # Maximum subdirectories per directory
  # Best practice: 8-10 subdirectories (cognitive load)
  max-subdirs: { max: 10 }

  # Disallow version suffixes (enforces "NO VERSION SUFFIXES IN CODE" rule)
  disallowed-patterns:
    - pattern: ".*_(v[0-9]+|new|old|temp|backup|copy)\\.(py|ts|tsx|js|jsx)$"
      message: "Version suffixes (_v2, _new, _old, _temp, _backup) are forbidden. Use git for versioning."
    - pattern: ".*_(v[0-9]+|new|old|temp|backup|copy)/$"
      message: "Version suffixes in directory names are forbidden. Use git for versioning."

# Advanced Rules
overrides:
  # Root level: Require essential documentation files
  - files: ['.']
    rules:
      max-files-in-dir: { max: 25 }  # Root can have more config files
      max-subdirs: { max: 15 }
      file-existence:
        "CLAUDE.md": "exists:1"
        "README.md": "exists:1"
        ".gitignore": "exists:1"

  # Backend: Python files and directories use snake_case
  - files: ['src/backend/**']
    rules:
      max-depth: { max: 7 }
      max-files-in-dir: { max: 20 }

      naming-convention:
        "*.py": "snake_case"
        "**/": "snake_case"

  # Backend services: Strict organization for core business logic
  - files: ['src/backend/services/**']
    rules:
      max-files-in-dir: { max: 15 }  # Services should be focused
      max-subdirs: { max: 8 }

  # Backend API routes: Keep route files organized
  - files: ['src/backend/api/routes/**']
    rules:
      max-files-in-dir: { max: 15 }

  # Backend tests: Allow more files but enforce organization
  - files: ['src/backend/tests/**']
    rules:
      max-depth: { max: 8 }
      max-files-in-dir: { max: 25 }  # Test directories can be larger

      naming-convention:
        "*.py": "snake_case"
        "**/": "snake_case"

      # Require conftest.py for pytest
      file-existence:
        "conftest.py|__init__.py": "exists:1"

  # Backend docs: Documentation organization
  - files: ['src/backend/docs/**', 'docs/**']
    rules:
      max-files-in-dir: { max: 20 }

  # TypeScript/React Frontend Rules
  - files: ['src/frontend/**']
    rules:
      max-depth: { max: 7 }
      max-files-in-dir: { max: 20 }

      naming-convention:
        # Files use kebab-case
        "*.ts": "kebab-case"
        "*.js": "kebab-case"
        "**/": "kebab-case"

  # React components: PascalCase for component files
  - files: ['src/frontend/src/components/**', 'src/frontend/src/screens/**', 'src/frontend/src/contexts/**']
    rules:
      max-files-in-dir: { max: 15 }  # Keep components focused

      naming-convention:
        "*.tsx": "PascalCase"
        "*.jsx": "PascalCase"
        "**/": "PascalCase"

      # Each component directory should have index or main component
      file-existence:
        "index.ts|index.tsx": "exists:0-1"

  # Scripts: Use snake_case and keep organized
  - files: ['scripts/**']
    rules:
      max-files-in-dir: { max: 15 }

      naming-convention:
        "*.py": "snake_case"
        "*.sh": "snake_case"
        "*.bat": "snake_case"
        "**/": "snake_case"

  # Config: kebab-case
  - files: ['config/**']
    rules:
      naming-convention:
        "**/": "kebab-case"

# Ignored paths (build artifacts, caches, dependencies)
ignore:
  - .git
  - .cache
  - .venv
  - api_venv
  - node_modules
  - __pycache__
  - .pytest_cache
  - .mypy_cache
  - .ruff_cache
  - dist
  - build
  - "*.egg-info"
  - .idea
  - .vscode
  - data/downloads
  - data/models
  - data/databases
  - src/backend/logs
  - src/frontend/frontend.log
  - ci-logs
  - .github
  - .qwen
  - .windsurf
  - .codex
